# 更新日志
所有该项目的重要变更都将记录在此文件中。
本项目遵循 [语义化版本控制](http://semver.org/)。


## [0.98.3] - 2025-08-04

### 新增
- 将用户作为资源访问规则的附加参数 [#44](https://github.com/xanasoft/MajorPrivacy/issues/44)

### 更改
- 降低了用户界面和服务的 CPU 使用率
- ImBox 在访问安全加密卷时不再更新容器文件的时间戳
- 改进了在 Windows 23H2 及更高版本中对商店应用程序的 Windows 防火墙规则处理

### 修复
- 修复了 ImBox.exe 中的旧卷无法再挂载的问题。请使用之前的版本保存数据，然后使用当前或更高版本重新创建卷。
- 修复了翻译未加载的问题
- 修复了 dat 编辑器：在打开第一个 .dat 文件后，后续 .dat 文件的树视图展开失败 [#61](https://github.com/xanasoft/MajorPrivacy/issues/61)
- 修复了在开启时间过滤器时，执行监视器不显示任何条目的问题 [#60](https://github.com/xanasoft/MajorPrivacy/issues/60)
- 修复了“添加到组”菜单中只有最后添加的组的问题 [#48](https://github.com/xanasoft/MajorPrivacy/issues/48)
- 修复了目录索引和读取权限未阻止创建文件夹的问题 [#68](https://github.com/xanasoft/MajorPrivacy/issues/68)



## [0.98.2] - 2025-07-22

### 新增
- 添加了阻止驱动事件的功能
- 添加 JsEngine, 可用于创建脚本规则
  - 大部分脚本的 API 还未实现，后续版本将支持更多的 API
- 添加总结页面
  - 显示当前系统状态
  - 发现的隐私问题
  - 相关事件
  - 完整跟踪日志
- 添加 windows 防火墙规则变化检测
  - 可检测规则变更，允许还原至原始状态

### 更改
- 更换至 VS2022 工具链
- 更换至 Qt 6
- 优化通知窗口

### 修复
- 修复了与驱动程序导致蓝屏死机的问题
- 修复了通过 安全 > 为文件签名 签名的文件在添加至数据库时出现斜杠的问题 [#73](https://github.com/xanasoft/MajorPrivacy/issues/73)
- 修复了在签名数据库中删除有签名的文件夹时出现的错误 [#74](https://github.com/xanasoft/MajorPrivacy/issues/74)
- 修复了 [UI] Tweak Description 未显示的问题 [#69](https://github.com/xanasoft/MajorPrivacy/issues/69)
- 修复了加载卷规则时出现的问题



## [0.98.1a] - 2025-05-23

### 修复
- [Driver/Service] 修复了当通过隐私代理启用 KernelIsolator 时，其注册表键值重置导致的自定义设置丢失问题。 [#71](github.com/xanasoft/MajorPrivacy/issues/71)


## [0.98.1] - 2025-05-23

### 新增
- 启用翻译支持
  - 如果你希望协助翻译或添加自己的语言，请在论坛中告知，目前已添加如下内容
    - 添加了德语 AI 翻译
    - 添加了波兰语 AI 翻译
    - 添加了土耳其语翻译（感谢 offhub）
    - 添加了简体中文翻译
- 安装程序中添加了 MS VC 运行库（ImDisk UI 需要此组件）
- 为“微调项”添加了翻译支持

### 修复
- 修复了安装程序无法删除驱动的问题
- 清理了“调整项”相关内容
- 修复了网络共享问题 [#47](https://github.com/xanasoft/MajorPrivacy/issues/47)
  - 注意：现在不再检测进程是否存在于网络位置
- 修复了驱动配置在系统关机时未保存的问题
- 修复了受保护文件夹显示问题 [#39](https://github.com/xanasoft/MajorPrivacy/issues/39)
- 修复了网络共享规则问题
  - 注意：规则中请不要使用映射驱动器字母，请使用完整 UNC 路径！！！

### 更改
- 重构了驱动代码


## [0.98.0] - 2025-05-06

### 新增
- 新增安装程序
- 为飞地进程增加了令牌完整性级别提升，从而实现更好的 UIPI（用户界面权限隔离）
- 新增驱动卸载保护
- 新增安全桌面提示功能，要求受信用户确认后才能关闭 Core 组件
- 在权限树中新增“复制路径”功能
- 在微调视图中新增“批准/还原微调”按钮
- 新增资源访问限制相关微调
- 新增执行控制相关微调
- 新增防火墙规则相关微调

### 更改
- 优化了微调视图
- 微调状态现在会保存到磁盘

### 修复
- 修复了在进程启动于飞地时，若代理崩溃导致驱动出现蓝屏的问题


## [0.97.2] - 2025-04-24

### 新增
- 新增 DNS 过滤服务器
- 新增支持防火墙规则模板；可使用通配符路径，定义 Windows 防火墙规则模板
- 日志和追踪数据显示中，增加每个程序项的内存使用列
- 新增总服务内存使用量指示器
- 新增每个进程的追踪预设配置
- 新增允许在封闭区调试进程的选项（安全性已禁用！！！）
- 向入口视图中新增操作过滤器
- 程序树结构中新增加展开/折叠全部按钮

### 更改
- 路径规则处理机制重构为新机制
  - 新机制现在可以支持更复杂的规则；目前采用简单的 DOS 模式，后续将进行调整并加入导入机制
- 防火墙弹窗现在会忽略传入连接尝试
- 重构了项目结构
- 优化并清理了框架代码
- 优化并清理了变体实现
- 日志和追踪数据现在分别存储在各程序的内存池中

### 修复
- 修复清理程序列表时发生死锁的问题
- 修复服务在 UI 仍然活动时停止导致的崩溃


## [0.97.1] - 2025-03-04

### 新增
- 新增了 DLL 注入机制
- 新增了可选的用户密码缓存功能
- 托盘菜单增加了更多选项
- 网络视图中增加了额外的过滤器

### 更改
- 重构并改进了签名校验机制
- 将入口记录移至单独文件
- 将 AccessLog.dat 重命名为 AccessRecord.dat，TrafficLog.dat 重命名为 TrafficRecord.dat
  - 注意：由于仍处于测试阶段，旧文件不会被自动加载或清理
  - 你可以手动从 C:\ProgramData\Xanasoft\MajorPrivacy 删除这些文件
- 现在默认不会再将任何记录（流量、执行、入口、访问）存储到磁盘
- 服务的 ini 文件名修改为 PrivacyAgent.ini
- 弹窗通知不再显示重复项

### 修复
- 修复了 ZwLockRegistryKey 的使用与 HVCI 不兼容的问题
- 修复了与 DLL 加载相关的进程保护界面崩溃问题
- 修复了设置防火墙过滤模式时的崩溃问题


## [0.97.0] - 2025-01-11

### 新增
- 新增在安全卷视图中添加文件夹的选项，以便更轻松地管理文件夹安全
- 新增重命名 安全卷 / 被保护目录 的选项
- 新增加载来自代理的大型数据集时的进度对话框
- 新增临时规则
- 新增禁用追踪/访问日志的选项
- 新增设置追踪/访问日志限制的选项
- 新增“调整信息”面板
- 新增集中存放签名数据库文件夹（C:\ProgramData\Xanasoft\MajorPrivacy\sig_db\）[#21](https://github.com/xanasoft/MajorPrivacy/issues/21)
  - 这样可在不修改第三方应用程序文件夹的情况下创建用户签名
  - 注意：应用程序文件夹中的 *.mpsig 文件仍将优先生效
- 新增对证书进行签名的能力（而非仅文件）
- 新增规则创建对话框中的自动命名功能
- 新增进程审计规则；可像保护进程一样监视进程但不施加任何保护措施
- 现在可从资料库视图对文件进行签名
- 现在可从资料库或模块视图中打开资源管理器的文件属性对话框
- 主面板的标签页新增了图标
- 规则创建对话框新增了程序选择器
- 新增基于用户密钥签名的配置保护 [#28](https://github.com/xanasoft/MajorPrivacy/issues/28)
- 新增基于 ZwLockRegistryKey 的 UserKey 保护
  - 注意：启用后驱动将在重启前无法卸载
- 新增专用 enclave 配置
- 飞地视图新增基于进程视图的侧边栏
- 飞地视图新增了图标
- 飞地视图新增了右键菜单
- 跟踪、规则 及其他视图新增了颜色标识
- 访问掩码列现在更加易读
- 新增签名数据库查看器

### 更改
- 重新设计了内部路径处理方式，因此文件版本也发生变更，来自旧版本的 *.dat 文件将被弃用
- 将 *.sig 文件重命名为 *.mpsig，并增强了其格式以适配未来，旧文件将不再加载
- API 流程更加简化

### 修复
- 修复了驱动保存规则时的问题
- 修复了部分调整项相关的问题


## [0.96.2] - 2024-12-01

### 新增
- 增加了访问树的清理功能，移除了所有指向不再存在或从未存在资源的条目
- 新增了清除单个程序项跟踪日志的选项
- 新增了忽略无效资源访问尝试（如路径语法错误等）的选项
- 最近的网络活动数值现已保存到 programs.dat 文件
- 程序项列新增了统计每个程序项访问过的所有文件数量的功能
- 新增了访问日志和跟踪日志的自动清理功能，默认保留时间为 14 天
- 新增了丢失程序文件的检测，丢失文件在程序树中以灰色标识
- 新增了清理选项，用于移除丢失的程序项
- 新增了自定义用户定义程序分组功能
- 新增了清空忽略列表的选项
- 新增了以服务方式运行隐私代理的选项
- 新增了挂载管理器查看器
- 程序编辑器窗口新增了浏览按钮
- 程序编辑器窗口新增了图标选择器
- 新增了针对安全卷的专用访问面板

### 更改
- 将访问树替换为更适合当前用户场景的新动态实现
- 程序树现在可以为每个页面展示不同的列选择
- 重新设计了 NT 到 DOS 路径解析
- 优化了维护菜单
- 改进了程序项的删除流程

### 修复
- 改进了驱动加载，增加了对于已安装过期驱动的兼容方案
- 修复了 CTreeItemModel 中的一致性问题
- 修复了 CTraceModel 崩溃的问题
- 修复了当服务修改其 BinaryPath 时出现的问题
- 修复了未能加载已安装 Win32 程序的模式问题
- 修复了 *.dat 查看器的性能问题


## [0.96.1] - 2024-11-12

### 新增
- 访问日志现在会保存到磁盘
- 新增跟踪注册表访问的选项
- 新增 dat 文件查看器
- 跟踪日志新增自动滚动功能
- 程序视图新增过滤器
- 新增窗口布局

### 更改
- 树形结构行为优化（双击可展开/收起所有子分支）
- 显著优化访问树的行为
- 优化流量视图
- 更改 Programs.dat 文件格式
  - 警告：旧文件将被丢弃且不会导入

### 修复
- 修复了驱动程序在操作后清理过程中的小问题
- 修复了驱动程序与 Windows 10 的兼容性问题
- 修复了启动缓慢导致错误提示的问题
- 修复了解析重解析点时的问题


## [0.96.0] - 2024-10-29

### 新增
- 新增清理所有代理日志的选项
- 为各种列表新增了视图过滤器和工具栏

### 更改
- 重构了卷规则处理方式，现在规则可以存储在卷根目录下的 $mpsys$ 文件中
  - 当卷未挂载时，此类规则不可被更改，从而增加了对恶意修改的防护
- 重构了密码传递至 imbox 的流程，使其更加安全
- 改进了挂载错误处理
- 改进了 GUI
- 改进了访问日志记录；被允许的操作现在会在操作后根据状态进行记录
  - 这样可以忽略对不存在对象的访问尝试（参见设置）
- 改进了查找栏
- 启动时，代理现在会枚举所有已加载的库

### 修复
- 修复了卷卸载相关问题
- 修复了驱动通信相关问题
- 修复了与 DNS 缓存相关的内存泄漏问题
- 修复了进程列表中的竞争条件问题


## [0.95.0] - 2024-06-30

### 新增
- 新增基于驱动的进程保护
- 新增基于驱动的进程控制规则
- 新增基于驱动的文件和文件夹保护
  - 可以阻止或限制对选定文件和文件夹的访问
  - 限制功能可仅允许文件夹浏览但不允许读取文件，或将路径设为只读
- 新增加密文件容器支持
  - 文件访问规则可设置为自动应用于加载的容器，仅允许受信任进程访问
- 新增打开文件列表
- 新增文件访问跟踪日志
- 新增文件访问监控；使用跟踪数据构建访问树，便于可视化
- 新增运行进程树
- 每个进程新增已加载模块（dlls）列表
- 新增执行监控，列出启动关系
- 新增入口监控，显示有哪些进程以何种访问掩码访问了其他进程
- 新增执行跟踪日志
- 新增 DNS 缓存查看器
- 新增用户密钥生成和文件签名机制


## [0.90.0] - 2023-12-31

### 新增
- 创建了全新的基于 Qt 的界面
- 实现了新的驱动程序，以支持高级隔离机制

### 更改
- 将 PrivateWin10 功能迁移至 C++
